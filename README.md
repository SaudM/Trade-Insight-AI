
# äº¤æ˜“ç¬”è®°AI (Trade Insight AI)

**English** | [**ç®€ä½“ä¸­æ–‡**](./README.zh-CN.md)

---

**äº¤æ˜“ç¬”è®°AI** æ˜¯ä¸€æ¬¾ä¸“ä¸ºäº¤æ˜“è€…è®¾è®¡çš„ç°ä»£åŒ–ã€ç”±AIé©±åŠ¨çš„äº¤æ˜“æ—¥å¿—åˆ†æå·¥å…·ã€‚å®ƒæ—¨åœ¨å¸®åŠ©æ‚¨è®°å½•ã€åˆ†æå¹¶ä»æ¯ä¸€ç¬”äº¤æ˜“ä¸­å­¦ä¹ ï¼Œé€šè¿‡æ·±åº¦æ•°æ®æ´å¯Ÿå’Œæ™ºèƒ½å»ºè®®ï¼Œæœ€ç»ˆæå‡æ‚¨çš„äº¤æ˜“è¡¨ç°ã€‚

[![äº¤æ˜“ç¬”è®°AI ä»ªè¡¨ç›˜](./docs/1.png)](https://studio--studio-4954880629-a3af8.us-central1.hosted.app/)

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- **ğŸ“ ç°ä»£åŒ–äº¤æ˜“æ—¥å¿—**: å¿«é€Ÿã€ä¾¿æ·åœ°è®°å½•æ‚¨çš„æ¯ä¸€ç¬”äº¤æ˜“ï¼ŒåŒ…æ‹¬å…¥åœº/å‡ºåœºç†ç”±ã€ä»“ä½å¤§å°ã€ç›ˆäºã€äº¤æ˜“å¿ƒæ€ç­‰å…³é”®ä¿¡æ¯ã€‚
- **ğŸ“Š å¯è§†åŒ–ä»ªè¡¨ç›˜**: é€šè¿‡ç›´è§‚çš„å›¾è¡¨å’Œå…³é”®ç»©æ•ˆæŒ‡æ ‡ï¼ˆKPIsï¼‰å…¨é¢äº†è§£æ‚¨çš„äº¤æ˜“è¡¨ç°ï¼ŒåŒ…æ‹¬ç´¯è®¡ç›ˆäºæ›²çº¿ã€èƒœç‡ã€ç›ˆäºæ¯”ã€å¹³å‡ç›ˆåˆ©/äºæŸç­‰ã€‚
- **ğŸ¤– AIé©±åŠ¨çš„æ·±åº¦åˆ†æ**:
    - **æ¯æ—¥åˆ†æ**: AIæ¯æ—¥æ€»ç»“æ‚¨çš„äº¤æ˜“æ´»åŠ¨ï¼Œè¯†åˆ«ä¼˜ç‚¹ä¸ä¸è¶³ï¼Œå¹¶åˆ†ææƒ…ç»ªå¯¹å†³ç­–çš„å½±å“ã€‚
    - **æ¯å‘¨å›é¡¾**: å‘ç°æ‚¨äº¤æ˜“è¡Œä¸ºä¸­çš„æˆåŠŸæ¨¡å¼å’Œå¸¸è§é”™è¯¯ï¼Œå¹¶è¯„ä¼°ä»“ä½ç®¡ç†çš„æœ‰æ•ˆæ€§ã€‚
    - **æœˆåº¦æ€»ç»“**: å¯¹æ¯”ä»Šã€æ˜¨ä¸¤æœˆçš„è¡¨ç°ï¼Œè¯†åˆ«é•¿æœŸå­˜åœ¨çš„é—®é¢˜ï¼Œå¹¶æä¾›ç³»ç»Ÿæ€§çš„è¿­ä»£å»ºè®®ã€‚
- **ğŸ’³ è®¢é˜…ç®¡ç†**: é›†æˆå¾®ä¿¡æ”¯ä»˜çš„å¤šå±‚çº§è®¢é˜…æœåŠ¡ï¼ˆæœˆåº¦/å­£åº¦/åŠå¹´/å¹´åº¦ï¼‰
- **ğŸ” æ•°æ®ç§æœ‰åŒ–ä¸å®‰å…¨**: æ”¯æŒFirebaseå’ŒPostgreSQLåŒé‡å­˜å‚¨æ–¹æ¡ˆï¼Œç¡®ä¿æ‚¨çš„äº¤æ˜“éšç§å’Œæ•°æ®æ‰€æœ‰æƒã€‚
- **ğŸ¨ ç°ä»£ã€ç¾è§‚ä¸”å“åº”å¼**: é‡‡ç”¨ `shadcn/ui` å’Œ `Tailwind CSS` æ„å»ºï¼Œæ”¯æŒæ˜æš—ä¸»é¢˜åˆ‡æ¢ï¼Œç¡®ä¿åœ¨æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡ä¸Šéƒ½æœ‰ä¸€æµçš„ç”¨æˆ·ä½“éªŒã€‚

| äº¤æ˜“æ—¥å¿— | AIåˆ†ææŠ¥å‘Š |
| :---: | :---: |
| ![äº¤æ˜“æ—¥å¿—](./docs/2.png) | ![AIåˆ†ææŠ¥å‘Š](./docs/3.png) |

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„è®¾è®¡

ç³»ç»Ÿé‡‡ç”¨ç°ä»£åŒ–çš„å…¨æ ˆæ¶æ„ï¼ŒåŸºäºå¾®æœåŠ¡ç†å¿µè®¾è®¡ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å±‚æ¬¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±‚ (Frontend Layer)                    â”‚
â”‚  Next.js 15.3.3 + React 18.3.1 + TypeScript + Tailwind CSS â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     APIå±‚ (API Layer)                       â”‚
â”‚        Next.js API Routes + Firebase Auth + å¾®ä¿¡æ”¯ä»˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼           â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ•°æ®å­˜å‚¨å±‚     â”‚ â”‚  AIå¤„ç†å±‚   â”‚ â”‚    ç¼“å­˜å±‚       â”‚
â”‚  PostgreSQL +   â”‚ â”‚ Google      â”‚ â”‚    Redis        â”‚
â”‚   Firebase      â”‚ â”‚ Genkit +    â”‚ â”‚                 â”‚
â”‚                 â”‚ â”‚ DeepSeek    â”‚ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶äº¤äº’å…³ç³»

#### 1. ç”¨æˆ·è®¤è¯æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as Frontend
    participant FA as Firebase Auth
    participant DB as PostgreSQL
    
    U->>F: ç™»å½•è¯·æ±‚
    F->>FA: éªŒè¯å‡­æ®
    FA->>F: è¿”å›JWT Token
    F->>DB: åˆ›å»º/æ›´æ–°ç”¨æˆ·è®°å½•
    DB->>F: ç¡®è®¤ç”¨æˆ·ä¿¡æ¯
    F->>U: ç™»å½•æˆåŠŸ
```

#### 2. AIåˆ†ææµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant API as API Layer
    participant AI as AI Service
    participant DB as Database
    
    U->>API: è¯·æ±‚AIåˆ†æ
    API->>DB: è·å–äº¤æ˜“æ•°æ®
    DB->>API: è¿”å›äº¤æ˜“è®°å½•
    API->>AI: è°ƒç”¨AIåˆ†ææœåŠ¡
    AI->>API: è¿”å›åˆ†æç»“æœ
    API->>DB: ä¿å­˜åˆ†ææŠ¥å‘Š
    API->>U: è¿”å›åˆ†æç»“æœ
```

### å…³é”®æŠ€æœ¯é€‰å‹å’Œè®¾è®¡å†³ç­–

| æŠ€æœ¯é¢†åŸŸ | é€‰å‹ | è®¾è®¡å†³ç­–ç†ç”± |
|---------|------|-------------|
| **å‰ç«¯æ¡†æ¶** | Next.js 15.3.3 | App Routeræ”¯æŒã€SSR/SSGèƒ½åŠ›ã€ä¼˜ç§€çš„å¼€å‘ä½“éªŒ |
| **æ•°æ®åº“** | PostgreSQL + Prisma | å…³ç³»å‹æ•°æ®åº“çš„ACIDç‰¹æ€§ã€å¤æ‚æŸ¥è¯¢æ”¯æŒã€ç±»å‹å®‰å…¨çš„ORM |
| **è®¤è¯ç³»ç»Ÿ** | Firebase Auth | æˆç†Ÿçš„è®¤è¯è§£å†³æ–¹æ¡ˆã€å¤šç§ç™»å½•æ–¹å¼æ”¯æŒ |
| **AIæœåŠ¡** | Google Genkit + DeepSeek | å¤šAIæä¾›å•†æ”¯æŒã€çµæ´»çš„æ¨¡å‹åˆ‡æ¢èƒ½åŠ› |
| **æ”¯ä»˜ç³»ç»Ÿ** | å¾®ä¿¡æ”¯ä»˜V3 | å›½å†…ç”¨æˆ·å‹å¥½ã€å®Œæ•´çš„è®¢é˜…ç®¡ç† |
| **ç¼“å­˜ç³»ç»Ÿ** | Redis | é«˜æ€§èƒ½ç¼“å­˜ã€ä¼šè¯ç®¡ç† |
| **å®¹å™¨åŒ–** | Docker + Docker Compose | ç¯å¢ƒä¸€è‡´æ€§ã€ä¾¿äºéƒ¨ç½²å’Œæ‰©å±• |

## ğŸš€ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯æ ˆ
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Next.js** | 15.3.3 | Reactå…¨æ ˆæ¡†æ¶ï¼Œæ”¯æŒSSR/SSG |
| **React** | 18.3.1 | ç”¨æˆ·ç•Œé¢åº“ |
| **TypeScript** | 5.x | ç±»å‹å®‰å…¨å¼€å‘ |
| **Tailwind CSS** | 3.4.1 | åŸå­åŒ–CSSæ¡†æ¶ |
| **Radix UI** | æœ€æ–°ç‰ˆ | æ— éšœç¢UIç»„ä»¶åº“ |
| **React Hook Form** | 7.54.2 | é«˜æ€§èƒ½è¡¨å•ç®¡ç† |
| **Zod** | 3.24.2 | è¿è¡Œæ—¶ç±»å‹éªŒè¯ |
| **Recharts** | 2.15.1 | æ•°æ®å¯è§†åŒ–å›¾è¡¨ |
| **Lucide React** | 0.475.0 | ç°ä»£å›¾æ ‡åº“ |

### åç«¯æŠ€æœ¯æ ˆ
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **PostgreSQL** | 15+ | ä¸»æ•°æ®åº“ |
| **Prisma** | 6.17.1 | æ•°æ®åº“ORM |
| **Firebase** | 11.9.1 | ç”¨æˆ·è®¤è¯å’Œå®æ—¶æ•°æ® |
| **Redis** | 7+ | ç¼“å­˜å’Œä¼šè¯å­˜å‚¨ |
| **Google Genkit** | 1.20.0 | AIæœåŠ¡æ¡†æ¶ |
| **DeepSeek API** | æœ€æ–° | AIæ¨¡å‹æœåŠ¡ |
| **å¾®ä¿¡æ”¯ä»˜V3** | 3.0.2 | æ”¯ä»˜å¤„ç† |

### AIæœåŠ¡æ¶æ„
ç³»ç»Ÿæ”¯æŒå¤šAIæä¾›å•†ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡ `AI_PROVIDER` çµæ´»åˆ‡æ¢ï¼š

- **Google Genkit**: ä½¿ç”¨Geminiæ¨¡å‹ï¼Œé€‚åˆå¤æ‚åˆ†æä»»åŠ¡
- **DeepSeek API**: é«˜æ€§ä»·æ¯”çš„ä¸­æ–‡ä¼˜åŒ–æ¨¡å‹

## ğŸ› ï¸ éƒ¨ç½²æ–¹å¼

### ç¯å¢ƒè¦æ±‚

- **Node.js**: ç‰ˆæœ¬ >= 20.0.0
- **PostgreSQL**: ç‰ˆæœ¬ >= 15.0
- **Redis**: ç‰ˆæœ¬ >= 7.0 (å¯é€‰ï¼Œç”¨äºç¼“å­˜)
- **Docker**: ç‰ˆæœ¬ >= 20.0 (å®¹å™¨åŒ–éƒ¨ç½²)

### å¼€å‘ç¯å¢ƒéƒ¨ç½²

#### 1. å…‹éš†ä»“åº“
```bash
git clone https://github.com/your-repo/Trade-Insight-AI.git
cd Trade-Insight-AI
```

#### 2. å®‰è£…ä¾èµ–
```bash
npm install
```

#### 3. ç¯å¢ƒå˜é‡é…ç½®
åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL="postgresql://trade_user:trade_password_2024@localhost:5432/trade_insight_ai"

# Redisé…ç½® (å¯é€‰)
REDIS_HOST=localhost
REDIS_PORT=6379

# Firebaseé…ç½®
NEXT_PUBLIC_FIREBASE_API_KEY=your_api_key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_domain
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_bucket
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
NEXT_PUBLIC_FIREBASE_APP_ID=your_app_id

# AIæœåŠ¡é…ç½®
AI_PROVIDER=deepseek  # å¯é€‰: 'google' æˆ– 'deepseek'

# DeepSeek APIé…ç½®
DEEPSEEK_API_KEY=your_deepseek_api_key
DEEPSEEK_BASE_URL=https://api.deepseek.com

# Google AIé…ç½® (å¦‚æœä½¿ç”¨Google AI)
GEMINI_API_KEY=your_gemini_api_key

# å¾®ä¿¡æ”¯ä»˜é…ç½®
WX_APPID=your_wechat_app_id
WX_MCHID=your_merchant_id
WX_V3_CODE=your_api_v3_key
WX_SERIAL_NO=your_certificate_serial_no
WX_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----
your_private_key_content
-----END PRIVATE KEY-----"
WX_NOTIFY_URL=https://your-domain.com/api/subscription/notify

# NextAuthé…ç½®
NEXTAUTH_URL=http://localhost:9002
NEXTAUTH_SECRET=your_nextauth_secret
```

#### 4. æ•°æ®åº“åˆå§‹åŒ–
```bash
# ç”ŸæˆPrismaå®¢æˆ·ç«¯
npx prisma generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
npm run db:migrate

# ç§å­æ•°æ® (å¯é€‰)
npm run db:seed
```

#### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
# å¯åŠ¨ä¸»åº”ç”¨
npm run dev

# å¯åŠ¨AIæœåŠ¡ (å¦ä¸€ä¸ªç»ˆç«¯)
npm run genkit:dev
```

è®¿é—® `http://localhost:9002` æŸ¥çœ‹åº”ç”¨ã€‚

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### Dockerå®¹å™¨åŒ–éƒ¨ç½² (æ¨è)

##### 1. ä½¿ç”¨Docker Compose
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f app
```

##### 2. æœåŠ¡é…ç½®è¯´æ˜
- **PostgreSQL**: ç«¯å£5432ï¼Œæ•°æ®æŒä¹…åŒ–åˆ° `./postgres_data`
- **Redis**: ç«¯å£6379ï¼Œæ•°æ®æŒä¹…åŒ–åˆ° `./redis_data`
- **åº”ç”¨æœåŠ¡**: ç«¯å£9002ï¼Œä½¿ç”¨é¢„æ„å»ºé•œåƒ

##### 3. ç¯å¢ƒå·®å¼‚é…ç½®

| ç¯å¢ƒ | æ•°æ®åº“ | ç¼“å­˜ | AIæœåŠ¡ | æ”¯ä»˜ |
|------|--------|------|--------|------|
| **å¼€å‘** | æœ¬åœ°PostgreSQL | å¯é€‰Redis | DeepSeek API | æµ‹è¯•ç¯å¢ƒ |
| **æµ‹è¯•** | å®¹å™¨PostgreSQL | Redis | Google Genkit | æ²™ç›’ç¯å¢ƒ |
| **ç”Ÿäº§** | äº‘æ•°æ®åº“ | Redisé›†ç¾¤ | å¤šAIè´Ÿè½½å‡è¡¡ | æ­£å¼ç¯å¢ƒ |

#### ä¼ ç»Ÿéƒ¨ç½²æ–¹å¼

##### 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
# ç±»å‹æ£€æŸ¥
npm run typecheck

# æ„å»ºåº”ç”¨
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start
```

##### 2. ä½¿ç”¨PM2ç®¡ç†è¿›ç¨‹
```bash
# å®‰è£…PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start npm --name "trade-insight-ai" -- start

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs trade-insight-ai
```

### éƒ¨ç½²åˆ°äº‘å¹³å°

#### Verceléƒ¨ç½²
1. è¿æ¥GitHubä»“åº“åˆ°Vercel
2. é…ç½®ç¯å¢ƒå˜é‡
3. è®¾ç½®æ„å»ºå‘½ä»¤: `npm run build`
4. è®¾ç½®è¾“å‡ºç›®å½•: `.next`

#### Firebase Hostingéƒ¨ç½²
```bash
# å®‰è£…Firebase CLI
npm install -g firebase-tools

# ç™»å½•Firebase
firebase login

# åˆå§‹åŒ–é¡¹ç›®
firebase init hosting

# éƒ¨ç½²
firebase deploy
```

## ğŸ’¾ å­˜å‚¨æ–¹æ¡ˆ

### æ•°æ®åº“æ¶æ„

#### PostgreSQLä¸»æ•°æ®åº“
ç³»ç»Ÿä½¿ç”¨PostgreSQLä½œä¸ºä¸»æ•°æ®åº“ï¼Œé€šè¿‡Prisma ORMè¿›è¡Œç®¡ç†ã€‚

##### æ ¸å¿ƒæ•°æ®æ¨¡å‹

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    email VARCHAR(255) UNIQUE NOT NULL,
    name VARCHAR(255) NOT NULL,
    google_id VARCHAR(255) UNIQUE,
    firebase_uid VARCHAR(255) UNIQUE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- äº¤æ˜“æ—¥å¿—è¡¨
CREATE TABLE trade_logs (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    trade_time TIMESTAMPTZ NOT NULL,
    symbol VARCHAR(50) NOT NULL,
    direction trade_direction NOT NULL,
    position_size VARCHAR(100) NOT NULL,
    entry_reason TEXT,
    exit_reason TEXT,
    trade_result TEXT NOT NULL,
    mindset_state TEXT NOT NULL,
    lessons_learned TEXT NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- è®¢é˜…è¡¨
CREATE TABLE subscriptions (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    plan_id plan_id NOT NULL,
    status subscription_status DEFAULT 'inactive',
    start_date TIMESTAMPTZ NOT NULL,
    end_date TIMESTAMPTZ NOT NULL,
    payment_provider payment_provider NOT NULL,
    payment_id VARCHAR(255) NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- AIåˆ†ææŠ¥å‘Šè¡¨
CREATE TABLE daily_analyses (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    date DATE NOT NULL,
    summary TEXT NOT NULL,
    strengths TEXT NOT NULL,
    weaknesses TEXT NOT NULL,
    emotional_impact TEXT NOT NULL,
    improvement_suggestions TEXT NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(user_id, date)
);
```

##### æšä¸¾ç±»å‹å®šä¹‰
```sql
-- äº¤æ˜“æ–¹å‘
CREATE TYPE trade_direction AS ENUM ('Buy', 'Sell', 'Long', 'Short', 'Close');

-- è®¢é˜…çŠ¶æ€
CREATE TYPE subscription_status AS ENUM ('active', 'inactive', 'cancelled', 'trialing');

-- è®¢é˜…è®¡åˆ’
CREATE TYPE plan_id AS ENUM ('monthly', 'quarterly', 'semi_annually', 'annually');

-- æ”¯ä»˜æä¾›å•†
CREATE TYPE payment_provider AS ENUM ('wechat_pay', 'alipay', 'stripe');
```

#### æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
```sql
-- æ€§èƒ½ä¼˜åŒ–ç´¢å¼•
CREATE INDEX idx_trade_logs_user_id ON trade_logs(user_id);
CREATE INDEX idx_trade_logs_trade_time ON trade_logs(trade_time);
CREATE INDEX idx_trade_logs_symbol ON trade_logs(symbol);
CREATE INDEX idx_subscriptions_user_id ON subscriptions(user_id);
CREATE INDEX idx_subscriptions_status ON subscriptions(status);
CREATE INDEX idx_daily_analyses_user_id ON daily_analyses(user_id);
CREATE INDEX idx_daily_analyses_date ON daily_analyses(date);
```

### æ•°æ®è¿ç§»å’Œåˆå§‹åŒ–

#### 1. æ•°æ®åº“è¿ç§»è„šæœ¬
```bash
# è¿è¡Œè¿ç§»
npm run db:migrate

# é‡ç½®æ•°æ®åº“
npm run db:reset

# æ¸…ç†æ•°æ®
npm run db:clean
```

#### 2. åˆå§‹åŒ–è„šæœ¬ (`scripts/init-db.sql`)
```sql
-- å¯ç”¨UUIDæ‰©å±•
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE trade_insight_ai;

-- è®¾ç½®æ—¶åŒº
SET timezone = 'UTC';
```

#### 3. ç§å­æ•°æ® (`scripts/seed-db.ts`)
```typescript
// åˆ›å»ºæµ‹è¯•ç”¨æˆ·å’Œç¤ºä¾‹æ•°æ®
async function seedDatabase() {
  // åˆ›å»ºæµ‹è¯•ç”¨æˆ·
  const testUser = await prisma.user.create({
    data: {
      email: 'test@example.com',
      name: 'Test User',
      firebaseUid: 'test-firebase-uid'
    }
  });

  // åˆ›å»ºç¤ºä¾‹äº¤æ˜“è®°å½•
  await prisma.tradeLog.createMany({
    data: [
      {
        userId: testUser.id,
        tradeTime: new Date(),
        symbol: 'AAPL',
        direction: 'Buy',
        positionSize: '100è‚¡',
        entryReason: 'æŠ€æœ¯åˆ†æçœ‹æ¶¨',
        tradeResult: '+$500',
        mindsetState: 'å†·é™åˆ†æ',
        lessonsLearned: 'ä¸¥æ ¼æ‰§è¡Œæ­¢æŸ'
      }
    ]
  });
}
```

### Redisç¼“å­˜ç­–ç•¥

#### ç¼“å­˜é…ç½®
```typescript
// lib/redis.ts
import Redis from 'redis';

export const redis = Redis.createClient({
  host: process.env.REDIS_HOST || 'localhost',
  port: parseInt(process.env.REDIS_PORT || '6379'),
  password: process.env.REDIS_PASSWORD,
  db: 0
});

// ç¼“å­˜ç­–ç•¥
export const cacheConfig = {
  userSession: { ttl: 3600 }, // 1å°æ—¶
  tradeData: { ttl: 1800 },   // 30åˆ†é’Ÿ
  aiAnalysis: { ttl: 86400 }  // 24å°æ—¶
};
```

## ğŸ“Š ç‰ˆæœ¬æ›´æ–°è¯´æ˜

### v2.0.0 (å½“å‰ç‰ˆæœ¬) - 2024å¹´12æœˆ
#### ğŸ‰ é‡å¤§æ›´æ–°
- **æ–°å¢**: PostgreSQLæ•°æ®åº“æ”¯æŒï¼Œæ›¿ä»£Firebase Firestoreä½œä¸ºä¸»æ•°æ®åº“
- **æ–°å¢**: Redisç¼“å­˜ç³»ç»Ÿï¼Œæå‡åº”ç”¨æ€§èƒ½
- **æ–°å¢**: Dockerå®¹å™¨åŒ–éƒ¨ç½²æ”¯æŒ
- **æ–°å¢**: å¤šAIæä¾›å•†æ”¯æŒ (Google Genkit + DeepSeek API)
- **æ–°å¢**: å®Œæ•´çš„è®¢é˜…ç®¡ç†ç³»ç»Ÿï¼Œé›†æˆå¾®ä¿¡æ”¯ä»˜
- **æ”¹è¿›**: å…¨é¢é‡æ„æ•°æ®æ¨¡å‹ï¼Œæ”¯æŒæ›´å¤æ‚çš„æŸ¥è¯¢å’Œåˆ†æ
- **æ”¹è¿›**: ä¼˜åŒ–AIåˆ†ææµç¨‹ï¼Œæä¾›æ›´å‡†ç¡®çš„äº¤æ˜“æ´å¯Ÿ

#### ğŸ”§ æŠ€æœ¯æ”¹è¿›
- å‡çº§åˆ°Next.js 15.3.3ï¼Œæ”¯æŒæœ€æ–°çš„App Router
- å¼•å…¥Prisma ORMï¼Œæä¾›ç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ
- å®ç°å¤šç¯å¢ƒéƒ¨ç½²é…ç½® (å¼€å‘/æµ‹è¯•/ç”Ÿäº§)
- æ·»åŠ å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

#### ğŸ› ä¿®å¤é—®é¢˜
- ä¿®å¤Firebaseè®¤è¯åœ¨ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šæ€§é—®é¢˜
- è§£å†³å¤§é‡äº¤æ˜“æ•°æ®çš„æ€§èƒ½ç“¶é¢ˆ
- ä¿®å¤AIåˆ†æç»“æœçš„ä¸€è‡´æ€§é—®é¢˜

### v1.0.0 - 2024å¹´10æœˆ
#### ğŸ‰ é¦–æ¬¡å‘å¸ƒ
- **åŸºç¡€åŠŸèƒ½**: äº¤æ˜“æ—¥å¿—è®°å½•å’Œç®¡ç†
- **AIåˆ†æ**: åŸºäºGoogle Genkitçš„æ¯æ—¥/æ¯å‘¨/æœˆåº¦åˆ†æ
- **ç”¨æˆ·è®¤è¯**: Firebase Authenticationé›†æˆ
- **æ•°æ®å­˜å‚¨**: Firebase Firestoreæ•°æ®åº“
- **UIè®¾è®¡**: åŸºäºshadcn/uiçš„ç°ä»£åŒ–ç•Œé¢

## ğŸ”„ å˜æ›´å†å²

### æ¶æ„æ¼”è¿›
```
v1.0.0: Firebase Only
â”œâ”€â”€ Frontend: Next.js + React
â”œâ”€â”€ Auth: Firebase Auth
â”œâ”€â”€ Database: Firestore
â””â”€â”€ AI: Google Genkit

v2.0.0: æ··åˆæ¶æ„ (å½“å‰)
â”œâ”€â”€ Frontend: Next.js 15.3.3 + React 18.3.1
â”œâ”€â”€ Auth: Firebase Auth
â”œâ”€â”€ Database: PostgreSQL (ä¸») + Firebase (è¾…)
â”œâ”€â”€ Cache: Redis
â”œâ”€â”€ AI: Google Genkit + DeepSeek API
â”œâ”€â”€ Payment: å¾®ä¿¡æ”¯ä»˜V3
â””â”€â”€ Deployment: Docker + Docker Compose
```

### æ•°æ®è¿ç§»æŒ‡å—
ä»v1.0.0å‡çº§åˆ°v2.0.0éœ€è¦è¿›è¡Œæ•°æ®è¿ç§»ï¼š

```bash
# 1. å¤‡ä»½Firebaseæ•°æ®
npm run backup:firebase

# 2. è¿è¡Œè¿ç§»è„šæœ¬
npm run migrate:v1-to-v2

# 3. éªŒè¯æ•°æ®å®Œæ•´æ€§
npm run verify:migration
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹
1. Forké¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹: `git commit -m 'Add amazing feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/amazing-feature`
5. åˆ›å»ºPull Request

### ä»£ç è§„èŒƒ
- ä½¿ç”¨TypeScriptè¿›è¡Œç±»å‹å®‰å…¨å¼€å‘
- éµå¾ªESLintå’ŒPrettieré…ç½®
- ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒåŠŸèƒ½
- æ›´æ–°ç›¸å…³æ–‡æ¡£

## ğŸ“„ è®¸å¯åè®®

æœ¬é¡¹ç›®é‡‡ç”¨ **å•†ä¸šæºä»£ç è®¸å¯ (Business Source License 1.1)**ã€‚

- **éå•†ä¸šç”¨é€”**: æ‚¨å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨ã€å¤åˆ¶ã€ä¿®æ”¹å’Œåˆ†å‘æœ¬è½¯ä»¶ï¼Œä½†ä»…é™äºéå•†ä¸šç›®çš„ã€‚
- **å•†ä¸šç”¨é€”**: ä»»ä½•å°†æœ¬è½¯ä»¶ç”¨äºå•†ä¸šäº§å“æˆ–æœåŠ¡çš„è¡Œä¸ºï¼Œéƒ½å¿…é¡»è·å¾—æˆ‘ä»¬çš„å•†ä¸šè®¸å¯ã€‚

**ç®€è€Œè¨€ä¹‹**:
- ğŸŸ¢ **å…è®¸**: ä¸ªäººå­¦ä¹ ã€ç ”ç©¶ã€è¿è¡Œåœ¨æ‚¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šç”¨äºä¸ªäººäº¤æ˜“åˆ†æã€‚
- ğŸ”´ **ç¦æ­¢**: åœ¨æœªè·å¾—å•†ä¸šè®¸å¯çš„æƒ…å†µä¸‹ï¼Œå°†æœ¬è½¯ä»¶ä½œä¸ºä»˜è´¹äº§å“ï¼ˆSaaSï¼‰æä¾›ç»™ä»–äººï¼Œæˆ–å°†å…¶é›†æˆåˆ°æ‚¨çš„å•†ä¸šäº§å“ä¸­ã€‚

åœ¨ **3 å¹´** åï¼Œæœ¬é¡¹ç›®çš„è®¸å¯å°†è‡ªåŠ¨è½¬æ¢ä¸ºå¯¹å•†ä¸šä½¿ç”¨æ›´å‹å¥½çš„ **Apache License 2.0**ã€‚

å¦‚æœæ‚¨å¯¹å•†ä¸šè®¸å¯æ„Ÿå…´è¶£ï¼Œè¯·è”ç³»æˆ‘ä»¬ã€‚

## ğŸ“ æ”¯æŒä¸è”ç³»

- **æŠ€æœ¯æ–‡æ¡£**: [æŸ¥çœ‹è¯¦ç»†æŠ€æœ¯æ–‡æ¡£](./docs/technical-documentation.md)
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/your-repo/Trade-Insight-AI/issues)
- **åŠŸèƒ½å»ºè®®**: [GitHub Discussions](https://github.com/your-repo/Trade-Insight-AI/discussions)

---
*æœ¬READMEæ–‡æ¡£ç”±AIååŠ©ç¼–å†™ï¼Œç¡®ä¿å†…å®¹çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚*
